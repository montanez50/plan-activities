import{q as w,r as d,j as e,a as D,y as A}from"./app-fbac857a.js";import{B as g}from"./Button-429df1c9.js";import{I as T}from"./Input-554d95c0.js";import{S as M}from"./Select-7b2120fa.js";import{_ as v,h as I,A as E}from"./AppLayout-cc157e47.js";import{T as i}from"./Table-8bfe4792.js";import{I as L}from"./IconPlus-f84e897e.js";import{I as P}from"./IconPencilPlus-69ec0e00.js";import{I as F}from"./IconTrash-05d0a7be.js";import"./react-select.esm-8b7c4e16.js";import"./createReactComponent-a8208e3e.js";const W=({id:t,item:o,changeActivity:a,...n})=>{const[r,l]=d.useState(!1),m=()=>{l(!r)};return d.useEffect(()=>{a(t,o,r)},[t,o,r,a]),e.jsx(i.TdNumber,{className:`px-2 ${r?"bg-green-600":""}`,onClick:()=>m(),...n})},$=({id:t,changeActivity:o})=>{const[a,n]=d.useState(""),r=l=>{n(l.target.value)};return d.useEffect(()=>{o(t,"text",a)},[t,a,o]),e.jsx(e.Fragment,{children:e.jsx(T,{id:`${t}-text`,name:`${t}-text`,value:a,onChange:r,className:"mt-1 block w-full",required:!0})})},z=({id:t,numbers:o,item:a,handleRemove:n,changeActivity:r})=>e.jsxs("tr",{children:[e.jsx(i.Td,{scope:"row",children:t+1}),e.jsx(i.Td,{children:e.jsx($,{id:t,changeActivity:r})}),o.map((l,m)=>e.jsx(W,{id:t,item:l,changeActivity:r},m)),e.jsx(i.TdNumber,{children:e.jsx(g,{icon:e.jsx(F,{strokeWidth:"1.5",size:"20"}),className:"bg-rose-200 text-rose-500 border border-rose-300 hover:border-rose-500 m-auto",noSubmit:1,onClick:()=>n(t)})})]}),R=({month:t,handleChange:o})=>{const a=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];return e.jsx("div",{className:"my-2",children:e.jsx(M,{label:"Mes",options:a,value:a.filter(n=>n.value===t)[0],onChange:o})})},B=t=>{const o=[],a=[],n=["D","L","M","M","J","V","S"],r=new Date,l=new Date(r.getFullYear(),t,0).getDate(),m=Array(l).fill().map((h,x)=>x+1);r.setDate(1),r.setMonth(t-1);const p=r.getDay();for(let h=0;h<l;h++){let x=new Date(r),b=(p+h)%7;x.setDate(h+1),o.push(n[b]),(b===0||b===6)&&a.push(h+1)}return{monthDays:o,colorDays:a,numbers:m,year:r.getFullYear()}};function J(){const{errors:t}=w().props,[o,a]=d.useState([]),[n,r]=d.useState(1),[l,m]=d.useState([]),{monthDays:p,colorDays:h,numbers:x,year:b}=B(n),y=s=>{r(s.value),a([])},N=s=>{const c=l.filter((j,u)=>u!==s),f=o.filter((j,u)=>u!==s);a(f),m(c)},S=()=>{const s=l[l.length-1]??-1;m([...l,s+1])},k=(s,c,f)=>{a(j=>{let u=j;return u[s]||(u[s]={}),u[s][c]||(u[s][c]=""),u[s][c]=f,u})},C=s=>{s.preventDefault(),o.length!==0?A.post(route("planification.store"),{year:b,month:n,activities:o},{onSuccess:()=>{v.success("Planificación creada correctamente!",{icon:"👏",style:{borderRadius:"10px",background:"#333",color:"#fff"}})}}):console.log("No hay planificaciones")};return d.useEffect(()=>{Object.entries(t).forEach(([s,c])=>{v.error(`${c}`)})},[t]),e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Crear Planificación"}),e.jsx("div",{className:"mb-5",children:e.jsx("div",{className:"flex flex-row items-center md:justify-between gap-5",children:e.jsx("div",{className:"w-full",children:e.jsx(R,{month:n,handleChange:y})})})}),e.jsx(i.Card,{title:"CREAR PLANIFICACIÓN",icon:e.jsx(I,{strokeWidth:"1.5",size:"20"}),children:e.jsxs("form",{onSubmit:C,children:[e.jsxs(i,{children:[e.jsxs(i.Thead,{children:[e.jsxs("tr",{children:[e.jsx(i.Th,{rowSpan:2,scope:"col",children:"#"}),e.jsx(i.Th,{rowSpan:2,scope:"col",children:"Actividades"}),p.map((s,c)=>e.jsx(i.ThNumber,{scope:"col",className:` py-3 ${s==="S"||s==="D"?"bg-blue-600 dark:text-white":"bg-gray-100"}`,children:s},c)),e.jsx(i.ThNumber,{rowSpan:2,scope:"col",className:"py-3 bg-gray-100",children:e.jsx("svg",{className:"h-5 w-5 text-red-500 m-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("tr",{children:x.map((s,c)=>e.jsx(i.ThNumber,{scope:"col",className:` py-3 ${h.includes(s)?"bg-blue-600 dark:text-white":"bg-gray-100"}`,children:s},c))})]}),e.jsx(i.Tbody,{children:l.map((s,c)=>e.jsx(z,{id:c,item:s,numbers:x,handleRemove:N,changeActivity:k},s))})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 p-2",children:[e.jsx(g,{label:"Agregar",icon:e.jsx(L,{strokeWidth:"1.5",size:"20"}),className:"bg-gray-200 text-gray-500 border border-gray-300 hover:border-gray-500",onClick:S,noSubmit:1}),e.jsx(g,{label:"Guardar",icon:e.jsx(P,{strokeWidth:"1.5",size:"20"}),className:"bg-teal-200 text-teal-500 border border-teal-300 hover:border-teal-500"})]})]})})]})}J.layout=t=>e.jsx(E,{children:t});export{J as default};
