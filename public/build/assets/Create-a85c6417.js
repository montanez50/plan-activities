import{q as y,r as d,j as e,a as D,y as A}from"./app-4c705fe6.js";import{B as g}from"./Button-3b469960.js";import{I as T}from"./Input-cba5d638.js";import{S as M}from"./Select-dce6251c.js";import{_ as v,g as I,A as E}from"./AppLayout-0f93b663.js";import{T as c}from"./Table-4b7e9b90.js";import{I as L}from"./IconPlus-a0dcb240.js";import{I as P}from"./IconPencilPlus-dad188cb.js";import{I as F}from"./IconTrash-42c58a3b.js";import"./react-select.esm-f1e8e4dc.js";import"./createReactComponent-33fd3947.js";const W=({id:t,item:o,changeActivity:l,...i})=>{const[r,a]=d.useState(!1),m=()=>{a(!r)};return d.useEffect(()=>{l(t,o,r)},[t,o,r,l]),e.jsx(c.TdNumber,{className:`px-2 ${r?"bg-green-600":""}`,onClick:()=>m(),...i})},$=({id:t,changeActivity:o})=>{const[l,i]=d.useState(""),r=a=>{i(a.target.value)};return d.useEffect(()=>{o(t,"text",l)},[t,l,o]),e.jsx(e.Fragment,{children:e.jsx(T,{id:`${t}-text`,name:`${t}-text`,value:l,onChange:r,className:"mt-1 block w-full",required:!0})})},z=({id:t,numbers:o,item:l,handleRemove:i,changeActivity:r})=>e.jsxs("tr",{children:[e.jsx(c.Td,{scope:"row",children:t+1}),e.jsx(c.Td,{children:e.jsx($,{id:t,changeActivity:r})}),o.map((a,m)=>e.jsx(W,{id:t,item:a,changeActivity:r},m)),e.jsx(c.TdNumber,{children:e.jsx(g,{icon:e.jsx(F,{strokeWidth:"1.5",size:"20"}),className:"bg-rose-200 text-rose-500 border border-rose-300 hover:border-rose-500 m-auto",noSubmit:1,onClick:()=>i(t)})})]}),R=({month:t,handleChange:o})=>{const{availableMonths:l}=y().props,r=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}].filter(a=>l.includes(a.value));return e.jsx("div",{className:"my-2",children:e.jsx(M,{label:"Mes",options:r,value:r.filter(a=>a.value===t)[0],onChange:o})})},B=t=>{const o=[],l=[],i=["D","L","M","M","J","V","S"],r=new Date,a=new Date(r.getFullYear(),t,0).getDate(),m=Array(a).fill().map((h,x)=>x+1);r.setDate(1),r.setMonth(t-1);const p=r.getDay();for(let h=0;h<a;h++){let x=new Date(r),b=(p+h)%7;x.setDate(h+1),o.push(i[b]),(b===0||b===6)&&l.push(h+1)}return{monthDays:o,colorDays:l,numbers:m,year:r.getFullYear()}};function J(){const{errors:t}=y().props,[o,l]=d.useState([]),[i,r]=d.useState(1),[a,m]=d.useState([]),{monthDays:p,colorDays:h,numbers:x,year:b}=B(i),N=s=>{r(s.value),l([])},S=s=>{const n=a.filter((j,u)=>u!==s),f=o.filter((j,u)=>u!==s);l(f),m(n)},k=()=>{const s=a[a.length-1]??-1;m([...a,s+1])},C=(s,n,f)=>{l(j=>{let u=j;return u[s]||(u[s]={}),u[s][n]||(u[s][n]=""),u[s][n]=f,u})},w=s=>{s.preventDefault(),o.length!==0?A.post(route("planification.store"),{year:b,month:i,activities:o},{onSuccess:()=>{v.success("Planificación creada correctamente!",{icon:"👏",style:{borderRadius:"10px",background:"#333",color:"#fff"}})}}):console.log("No hay planificaciones")};return d.useEffect(()=>{Object.entries(t).forEach(([s,n])=>{v.error(`${n}`)})},[t]),e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Crear Planificación"}),e.jsx("div",{className:"mb-5",children:e.jsx("div",{className:"flex flex-row items-center md:justify-between gap-5",children:e.jsx("div",{className:"w-full",children:e.jsx(R,{month:i,handleChange:N})})})}),e.jsx(c.Card,{title:"CREAR PLANIFICACIÓN",icon:e.jsx(I,{strokeWidth:"1.5",size:"20"}),children:e.jsxs("form",{onSubmit:w,children:[e.jsxs(c,{children:[e.jsxs(c.Thead,{children:[e.jsxs("tr",{children:[e.jsx(c.Th,{rowSpan:2,scope:"col",children:"#"}),e.jsx(c.Th,{rowSpan:2,scope:"col",children:"Actividades"}),p.map((s,n)=>e.jsx(c.ThNumber,{scope:"col",className:` py-3 ${s==="S"||s==="D"?"bg-blue-600 dark:text-white":"bg-gray-100"}`,children:s},n)),e.jsx(c.ThNumber,{rowSpan:2,scope:"col",className:"py-3 bg-gray-100",children:e.jsx("svg",{className:"h-5 w-5 text-red-500 m-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("tr",{children:x.map((s,n)=>e.jsx(c.ThNumber,{scope:"col",className:` py-3 ${h.includes(s)?"bg-blue-600 dark:text-white":"bg-gray-100"}`,children:s},n))})]}),e.jsx(c.Tbody,{children:a.map((s,n)=>e.jsx(z,{id:n,item:s,numbers:x,handleRemove:S,changeActivity:C},s))})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 p-2",children:[e.jsx(g,{label:"Agregar",icon:e.jsx(L,{strokeWidth:"1.5",size:"20"}),className:"bg-gray-200 text-gray-500 border border-gray-300 hover:border-gray-500",onClick:k,noSubmit:1}),e.jsx(g,{label:"Guardar",icon:e.jsx(P,{strokeWidth:"1.5",size:"20"}),className:"bg-teal-200 text-teal-500 border border-teal-300 hover:border-teal-500"})]})]})})]})}J.layout=t=>e.jsx(E,{children:t});export{J as default};
